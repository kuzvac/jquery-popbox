!function(t,o,i){i.fn.popbox=function(t){var e=i.extend({selector:this.selector,open:".open",box:".box",arrow:".arrow",arrow_border:".arrow-border",close:".close",direction:"bottom"},t),r={open:function(t){t.preventDefault();var o=i(this),n=i(this).parent().find(e.box);n.find(e.arrow).addClass("arrow"+e.direction),n.find(e.arrow_border).addClass("arrow"+e.direction+"-border"),"bottom"==e.direction||"top"==e.direction?(n.find(e.arrow).css({left:n.width()/2-10}),n.find(e.arrow_border).css({left:n.width()/2-10})):(n.find(e.arrow).css({top:n.height()/2-10}),n.find(e.arrow_border).css({top:n.height()/2-10})),"block"==n.css("display")?r.close():("bottom"==e.direction&&n.css({display:"block",top:10,left:o.parent().width()/2-n.width()/2}),"right"==e.direction&&n.css({display:"block",left:o.parent().width()/2+n.width()/4,bottom:o.parent().height()/2-n.height()/2}),"left"==e.direction&&n.css({display:"block",right:o.parent().width()/2+n.width()/4,bottom:o.parent().height()/2-n.height()/2}),"top"==e.direction&&n.css({display:"block",bottom:10+o.parent().height(),right:o.parent().width()/2-n.width()/2}))},close:function(){i(e.box).fadeOut("fast")}};return i(o).bind("keyup",function(t){27==t.keyCode&&r.close()}),i(o).bind("click",function(t){i(t.target).closest(e.selector).length||r.close()}),this.each(function(){i(this).css({width:i(e.box).width()}),i(e.open,this).bind("click",r.open),i(e.open,this).parent().find(e.close).bind("click",function(t){t.preventDefault(),r.close()})})}}(this,document,jQuery);